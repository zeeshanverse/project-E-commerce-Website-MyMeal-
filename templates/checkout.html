<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout | MyMeal.com</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <style>
    body {
        font-family: 'Bree Serif', serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }

    h1 {
        font-family: 'Baloo Bhai 2', cursive;
        font-size: 3rem;
        color: #14635e;
        text-align: center;
    }
    /* h4{
        font-family: 'Baloo Bhai 2', cursive;
        font-size: 3rem;
        color: #14635e;
        text-align: center;
    } */

    table {
        width: 80%;
        margin: 20px auto;
        border-collapse: collapse;
        background-color: rgba(177, 213, 228, 0.474);
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    th, td {
        padding: 12px;
        text-align: center;
    }

    th {
        color: #14635e;
        background-color: rgba(177, 213, 228, 0.474);
    }

    tr:hover {
        background-color: rgba(177, 213, 228, 0.474);
    }

    button {
        padding: 8px 12px;
        background-color: #14635e;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    button:hover {
        background-color: #0a5345;
    }

    .total-amount {
        text-align: center;
        font-size: 1.5rem;
        margin-top: 20px;
        color: #14635e;
    }

    form {
        width: 80%;
        margin: 20px auto;
    }

    form label {
        display: block;
        margin-bottom: 5px;
    }

    form input, form textarea {
        width: 100%;
        padding: 10px;
        margin-bottom: 20px;
        border: 1px solid #ddd;
        border-radius: 5px;
    }

    /* Style for the Payment Method Dropdown */
    select#payment_method {
        width: 100%;
        padding: 10px;
        margin-bottom: 20px;
        border: 1px solid #ddd;
        border-radius: 5px;
        background-color: rgba(177, 213, 228, 0.474); /* Matches the table background */
        color: #333;
        font-size: 1rem;
        transition: background-color 0.3s, border 0.3s;
        cursor: pointer;
    }

    select#payment_method:focus {
        border: 2px solid #14635e; /* Focused state */
        background-color: #e9f1f3; /* Slight color change on focus */
    }

    select#payment_method:hover {
        background-color: rgba(177, 213, 228, 0.6); /* Slight darkening on hover */
    }

    .checkout-button {
        text-align: center;
        margin-top: 20px;
    }

    .mid-container {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 5%;
    }

    .hidden {
        display: none;
    }
    .empty-cart{
        /* font-family: 'Bree Serif', serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333; */
        display: flex;
        justify-content: center;
        align-items: center;
        height: 5%;
        font-size: larger;
        font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
        color: red;
    }
</style>


    <script>
        function showPaymentDetails() {
            // Hide all payment details sections first
            document.getElementById('cod-details').classList.add('hidden');
            document.getElementById('card-details').classList.add('hidden');
            document.getElementById('wallet-details').classList.add('hidden');
            
            // Get the selected payment method
            var paymentMethod = document.getElementById('payment_method').value;
            
            // Show relevant payment details section
            if (paymentMethod === 'cod') {
                document.getElementById('cod-details').classList.remove('hidden');
            } else if (paymentMethod === 'card') {
                document.getElementById('card-details').classList.remove('hidden');
            } else if (paymentMethod === 'wallet') {
                document.getElementById('wallet-details').classList.remove('hidden');
            }
        }
    </script>
</head>

<body onload="showPaymentDetails()">
    <h1 class="mid-container">Checkout</h1>

    {% if cart %}
    <table>
        <thead>
            <tr>
                <th>Item</th>
                <th>Price (₹)</th>
                <th>Quantity</th>
                <th>Subtotal (₹)</th>
            </tr>
        </thead>
        <tbody>
            {% for item in cart %}
            <tr>
                <td>{{ item.item }}</td>
                <td>{{ item.price }}</td>
                <td>{{ item.quantity }}</td>
                <td>{{ item.price * item.quantity }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Display total amount -->
    <div class="total-amount">
        <h3>Total Amount: ₹ {{ total_amount }}</h3>
    </div>

    <!-- Delivery Information Form -->
    <form action="{{ url_for('place_order') }}" method="POST">
        <!-- Payment Method Section -->
        <label for="payment_method">Payment Method:</label>
        <select id="payment_method" name="payment_method" onchange="showPaymentDetails()" required>
            <option value="" disabled selected>Select a payment method</option>
            <option value="cod">Cash on Delivery</option>
            <option value="card">Credit/Debit Card</option>
            <option value="wallet">Digital Wallet</option>
        </select>
        <br>
        
        <!-- Cash on Delivery Details -->
        <div id="cod-details" class="hidden">
            <h4>Delivery Information</h4><br>
            <h3>Cash on Delivery Information</h3><br>
            <label for="name">Full Name:</label>
            <input type="text" id="name" name="name" required placeholder="Enter your full name">

            <label for="address">Delivery Address:</label>
            <textarea id="address" name="address" rows="4" required placeholder="address.. "></textarea>

            <label for="phone">Phone Number:</label>
            <input type="tel" id="phone" name="phone" required>
            <p>We'll deliver your items to the address above, and you can pay the delivery person in cash.</p>
        </div>

        <!-- Credit/Debit Card Details -->
        <div id="card-details" class="hidden">
            <h4>Card Details</h4><br>
            <label for="card_number">Card Number:</label>
            <input type="text" id="card_number" name="card_number" placeholder="1234 5678 9012 3456">

            <label for="expiry_date">Expiry Date:</label>
            <input type="text" id="expiry_date" name="expiry_date" placeholder="MM/YY">

            <label for="cvv">CVV:</label>
            <input type="number" id="cvv" name="cvv" placeholder="123">
        </div>

        <!-- Digital Wallet Details -->
        <div id="wallet-details" class="hidden">
            <h4>Digital Wallet Details</h4><br>
            <label for="wallet_number">Wallet Number:</label>
            <input type="text" id="wallet_number" name="wallet_number" placeholder="Wallet Account Number">
        </div>

        <!-- Place Order Button -->
        <div class="checkout-button">
            <button type="submit">Place Order</button>
        </div>
    </form>

    {% else %}
    <br>
    <br>
    <h4 class="empty-cart">Your cart is empty !!!</h4>
    <div class="checkout-button">
        <a href="{{ url_for('order') }}">Go back to menu</a>
    </div>
    {% endif %}
</body>

</html>
